import{r as n,j as e}from"./react-vendor-D3yaKSZ_.js";import{a as p}from"./index-RLKMLl1l.js";import"./chart-vendor-BsnJAHr2.js";import"./bootstrap-vendor-CM53U_Of.js";import"./vendor-axios-ngrFHoWO.js";import"./pdf-vendor-BZobkf7J.js";import"./vendor-utils-DLELI0UM.js";import"./excel-vendor-6kUf8nhb.js";function O(d){if(!d)return"";const c=String(d);return c.includes("T")?c.split("T")[0]:c}function G(){var E,W,L;const[d,c]=n.useState([]),[_,R]=n.useState(!1),[m,N]=n.useState(null),[i,b]=n.useState(""),[h,u]=n.useState(null),[w,f]=n.useState(null),[o,k]=n.useState(null),[M,A]=n.useState(""),[y,C]=n.useState(null),[g,S]=n.useState("");n.useEffect(()=>{j()},[]);const j=async()=>{R(!0);try{const s=await p.get("/api/appointments?status=pending");c(s.data)}catch(s){console.error("Failed to load appointments",s)}finally{R(!1)}},H=async s=>{var r,a,l,x,t;u(s);try{await p.post(`/api/appointments/${s}/approve`),j()}catch(v){console.error("Approve error:",((r=v.response)==null?void 0:r.data)||v.message),alert(((l=(a=v.response)==null?void 0:a.data)==null?void 0:l.message)||((t=(x=v.response)==null?void 0:x.data)==null?void 0:t.error)||"Approval failed")}finally{u(null)}},P=s=>{if(s.payment_method!=="hmo")return alert("Only for HMO payments");f(s.id),k(s),A(""),C(null),S(""),b("")},z=async()=>{var s,r;try{const{data:a}=await p.post(`/api/appointments/${w}/hmo/reveal`,{password:M});C(a)}catch(a){alert(((r=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:r.message)||"Invalid password or error")}},I=async()=>{var s,r;if(!i.trim())return alert("Please enter a note to send to the patient.");try{await p.post(`/api/appointments/${w}/hmo/notify`,{message:i,coverage_amount:g?Number(g):void 0,approve:!0}),f(null),k(null),C(null),S(""),b(""),j()}catch(a){alert(((r=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to send coverage update")}},Y=async()=>{var s,r,a;if(!i.trim())return alert("Note is required");u(m.id);try{await p.post(`/api/appointments/${m.id}/reject`,{note:i}),N(null),b(""),j()}catch(l){console.error("Reject error:",((s=l.response)==null?void 0:s.data)||l.message),alert(((a=(r=l.response)==null?void 0:r.data)==null?void 0:a.error)||"Rejection failed")}finally{u(null)}};return e.jsxs("div",{className:"w-100",style:{padding:0,margin:0},children:[e.jsx("div",{className:"container-fluid px-0 py-0",children:e.jsx("div",{className:"row g-0",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"bg-white p-4",style:{minHeight:"100vh"},children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h1",{className:"h3 fw-bold mb-0",style:{color:"#1e293b"},children:"Pending Appointments"}),_&&e.jsxs("div",{className:"d-flex align-items-center text-muted",children:[e.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("small",{children:"Loading appointments..."})]})]}),d.length===0?e.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",style:{minHeight:"60vh"},children:[e.jsx("i",{className:"bi bi-calendar-x display-1 d-block mb-3 text-muted"}),e.jsx("h4",{className:"fw-normal text-muted",children:"No pending appointments"}),e.jsx("p",{className:"text-muted",children:"All appointments have been processed."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover mb-0",style:{borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[e.jsx("thead",{style:{background:"linear-gradient(135deg, #00b4d8 0%, #0077b6 100%)",color:"white"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-0 py-3 px-4 fw-semibold",children:"#"}),e.jsx("th",{className:"border-0 py-3 px-4 fw-semibold",children:"Service"}),e.jsx("th",{className:"border-0 py-3 px-4 fw-semibold",children:"Date"}),e.jsx("th",{className:"border-0 py-3 px-4 fw-semibold",children:"Time"}),e.jsx("th",{className:"border-0 py-3 px-4 fw-semibold",children:"Payment"}),e.jsx("th",{className:"border-0 py-3 px-4 fw-semibold",children:"Status"}),e.jsx("th",{className:"border-0 py-3 px-4 fw-semibold text-center",children:"Action"})]})}),e.jsx("tbody",{children:d.map((s,r)=>{var a,l,x;return e.jsxs("tr",{style:{borderBottom:"1px solid #f1f3f4",transition:"background-color 0.2s ease"},onMouseEnter:t=>{t.target.style.backgroundColor="#f8f9fa"},onMouseLeave:t=>{t.target.style.backgroundColor="transparent"},children:[e.jsx("td",{className:"py-3 px-4 fw-semibold",style:{color:"#6c757d"},children:r+1}),e.jsx("td",{className:"py-3 px-4 fw-semibold",style:{color:"#1e293b"},children:(a=s.service)==null?void 0:a.name}),e.jsx("td",{className:"py-3 px-4",style:{color:"#495057"},children:s.date}),e.jsx("td",{className:"py-3 px-4",style:{color:"#495057"},children:s.time_slot}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"badge",style:{backgroundColor:s.payment_method==="hmo"?"#6366f1":"#00b4d8",color:"white",fontSize:"0.75rem",fontWeight:"600",padding:"0.4rem 0.8rem",borderRadius:"20px"},children:(l=s.payment_method)==null?void 0:l.toUpperCase()})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"badge",style:{backgroundColor:"#ffc107",color:"#000",fontSize:"0.75rem",fontWeight:"600",padding:"0.4rem 0.8rem",borderRadius:"20px"},children:(x=s.status)==null?void 0:x.toUpperCase()})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsxs("div",{className:"d-flex justify-content-center gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>H(s.id),disabled:h===s.id,className:"btn btn-sm text-white rounded-pill disabled:opacity-50",style:{background:"linear-gradient(135deg, #00b4d8 0%, #0077b6 100%)",border:"none",fontWeight:"600",transition:"all 0.3s ease",padding:"0.5rem 1rem",fontSize:"0.8rem"},onMouseEnter:t=>{t.target.disabled||(t.target.style.background="linear-gradient(135deg, #0096c7 0%, #0056b3 100%)",t.target.style.transform="translateY(-1px)")},onMouseLeave:t=>{t.target.disabled||(t.target.style.background="linear-gradient(135deg, #00b4d8 0%, #0077b6 100%)",t.target.style.transform="translateY(0)")},children:[e.jsx("i",{className:"bi bi-check-circle me-1"}),h===s.id?"Approving...":"Approve"]}),s.payment_method==="hmo"&&e.jsxs("button",{onClick:()=>P(s),className:"btn btn-sm text-white rounded-pill",style:{background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",border:"none",fontWeight:"600",transition:"all 0.3s ease",padding:"0.5rem 1rem",fontSize:"0.8rem"},onMouseEnter:t=>{t.target.style.background="linear-gradient(135deg, #5b5bd6 0%, #4338ca 100%)",t.target.style.transform="translateY(-1px)"},onMouseLeave:t=>{t.target.style.background="linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",t.target.style.transform="translateY(0)"},children:[e.jsx("i",{className:"bi bi-shield-check me-1"}),"Verify HMO"]}),e.jsxs("button",{onClick:()=>N(s),disabled:h===s.id,className:"btn btn-sm text-white rounded-pill disabled:opacity-50",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",border:"none",fontWeight:"600",transition:"all 0.3s ease",padding:"0.5rem 1rem",fontSize:"0.8rem"},onMouseEnter:t=>{t.target.disabled||(t.target.style.background="linear-gradient(135deg, #c82333 0%, #a71e2a 100%)",t.target.style.transform="translateY(-1px)")},onMouseLeave:t=>{t.target.disabled||(t.target.style.background="linear-gradient(135deg, #dc3545 0%, #c82333 100%)",t.target.style.transform="translateY(0)")},children:[e.jsx("i",{className:"bi bi-x-circle me-1"}),h===s.id?"Rejecting...":"Reject"]})]})})]},s.id)})})]})})]})})})}),m&&e.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{backgroundColor:"rgba(0,0,0,0.5)",zIndex:1050},children:e.jsx("div",{className:"bg-white rounded-3 shadow-lg",style:{width:"400px",maxWidth:"90vw"},children:e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"h4 fw-bold mb-3",style:{color:"#1e293b"},children:"Reject Appointment"}),e.jsxs("p",{className:"text-muted mb-3",children:["Enter reason for rejecting appointment on ",e.jsx("strong",{children:m.date})," at"," ",e.jsx("strong",{children:m.time_slot})]}),e.jsx("textarea",{value:i,onChange:s=>b(s.target.value),className:"form-control mb-3",rows:3,placeholder:"Enter rejection reason...",style:{borderRadius:"8px",border:"2px solid #e9ecef"}}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>N(null),style:{borderRadius:"8px",fontWeight:"600"},children:"Cancel"}),e.jsxs("button",{className:"btn text-white",onClick:Y,style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",border:"none",borderRadius:"8px",fontWeight:"600"},onMouseEnter:s=>{s.target.style.background="linear-gradient(135deg, #c82333 0%, #a71e2a 100%)"},onMouseLeave:s=>{s.target.style.background="linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:[e.jsx("i",{className:"bi bi-x-circle me-1"}),"Reject"]})]})]})})}),w&&e.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{backgroundColor:"rgba(0,0,0,0.5)",zIndex:1060},children:e.jsx("div",{className:"bg-white rounded-3 shadow-lg",style:{width:"520px",maxWidth:"90vw"},children:e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"h4 fw-bold mb-3",style:{color:"#1e293b"},children:"HMO Verification"}),o&&e.jsx("div",{className:"mb-3 p-3 rounded",style:{backgroundColor:"#f8f9fa"},children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("strong",{children:"Service:"})," ",((E=o.service)==null?void 0:E.name)||"—"]}),e.jsxs("div",{className:"col-6",children:[e.jsx("strong",{children:"Price:"})," ₱",Number(((W=o.service)==null?void 0:W.price)??0).toLocaleString()]}),e.jsxs("div",{className:"col-12 mt-2",children:[e.jsx("strong",{children:"Date:"})," ",O(o.date)]})]})}),y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3 p-3 rounded",style:{backgroundColor:"#f8f9fa"},children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("strong",{children:"Provider:"})," ",y.provider_name]}),e.jsxs("div",{className:"col-6",children:[e.jsx("strong",{children:"HMO Number:"})," ",y.hmo_number||"—"]}),e.jsxs("div",{className:"col-12 mt-2",children:[e.jsx("strong",{children:"Name on Card:"})," ",y.patient_fullname_on_card||"—"]})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Coverage Amount (₱)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:g,onChange:s=>S(s.target.value),style:{borderRadius:"8px",border:"2px solid #e9ecef"}}),o&&g&&e.jsxs("div",{className:"text-muted mt-1 small",children:["Estimated balance: ₱",Math.max(0,Number(((L=o.service)==null?void 0:L.price)??0)-Number(g||0)).toLocaleString()]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Note to patient"}),e.jsx("textarea",{className:"form-control",rows:3,value:i,onChange:s=>b(s.target.value),placeholder:"What coverage means, balance, etc.",style:{borderRadius:"8px",border:"2px solid #e9ecef"}})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>{f(null),k(null)},style:{borderRadius:"8px",fontWeight:"600"},children:"Close"}),e.jsxs("button",{className:"btn text-white",onClick:I,style:{background:"linear-gradient(135deg, #00b4d8 0%, #0077b6 100%)",border:"none",borderRadius:"8px",fontWeight:"600"},onMouseEnter:s=>{s.target.style.background="linear-gradient(135deg, #0096c7 0%, #0056b3 100%)"},onMouseLeave:s=>{s.target.style.background="linear-gradient(135deg, #00b4d8 0%, #0077b6 100%)"},children:[e.jsx("i",{className:"bi bi-send me-1"}),"Send & Approve"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-muted mb-3",children:"Enter your password to reveal patient HMO details."}),e.jsx("input",{type:"password",className:"form-control mb-3",value:M,onChange:s=>A(s.target.value),placeholder:"Your password",style:{borderRadius:"8px",border:"2px solid #e9ecef"}}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>f(null),style:{borderRadius:"8px",fontWeight:"600"},children:"Cancel"}),e.jsxs("button",{className:"btn text-white",onClick:z,style:{background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",border:"none",borderRadius:"8px",fontWeight:"600"},onMouseEnter:s=>{s.target.style.background="linear-gradient(135deg, #5b5bd6 0%, #4338ca 100%)"},onMouseLeave:s=>{s.target.style.background="linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"},children:[e.jsx("i",{className:"bi bi-eye me-1"}),"Reveal"]})]})]})]})})})]})}export{G as default};
